<!DOCTYPE html>
<html lang="ja" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>販売管理システム - 完全版</title>
    <!-- 外部ライブラリ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
      :root {
        --primary: #2c5aa0;
        --primary-hover: #1e3a5f;
        --background: #f5f7fa;
        --card-bg: #ffffff;
        --text-color: #333333;
      }

      body {
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', 'Meiryo', sans-serif;
        background-color: var(--background);
        color: var(--text-color);
        min-height: 100vh;
      }

      /* ログイン画面 */
      .login-container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 9999;
      }

      .login-card {
        background: white;
        padding: 2.5rem;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        width: 100%;
        max-width: 400px;
        text-align: center;
      }

      .login-header {
        color: var(--primary);
        margin-bottom: 2rem;
        border-bottom: 2px solid #eee;
        padding-bottom: 1rem;
      }

      /* アプリケーション全体 */
      .app-container {
        display: none; /* 初期状態は非表示 */
        flex-direction: column;
        min-height: 100vh;
      }

      .app-header {
        background: var(--primary);
        color: white;
        padding: 1rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .app-title {
        margin: 0;
        font-size: 1.5rem;
        font-weight: bold;
        color: white;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      /* タブメニュー */
      .tab-menu {
        background: #1e3a5f;
        display: flex;
        padding: 0 1rem;
        overflow-x: auto;
      }

      .tab-button {
        background: transparent;
        border: none;
        color: #ccc;
        padding: 1rem 1.5rem;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: bold;
        font-size: 1rem;
        white-space: nowrap;
        border-bottom: 3px solid transparent;
      }

      .tab-button:hover {
        color: white;
        background: rgba(255, 255, 255, 0.1);
      }

      .tab-button.active {
        color: white;
        border-bottom: 3px solid white;
        background: rgba(255, 255, 255, 0.05);
      }

      /* メインコンテンツ */
      .main-content {
        padding: 2rem;
        max-width: 1400px;
        margin: 0 auto;
        width: 100%;
        flex: 1;
      }

      .page-section {
        display: none;
        animation: fadeIn 0.3s ease-in-out;
      }

      .page-section.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* カードコンポーネント */
      .card {
        background: var(--card-bg);
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .card h2,
      .card h3 {
        color: var(--primary);
        margin-top: 0;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
      }

      /* グリッドレイアウト */
      .grid-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .stat-card {
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        text-align: center;
        border-left: 5px solid var(--primary);
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      }

      .stat-value {
        font-size: 2rem;
        font-weight: bold;
        color: var(--primary);
        margin: 0.5rem 0;
      }

      .stat-label {
        color: #666;
        font-size: 0.9rem;
      }

      .grid-dashboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 1.5rem;
      }

      .chart-container {
        position: relative;
        height: 300px;
        width: 100%;
      }

      /* ファネル表示 */
      .funnel-container {
        display: flex;
        flex-direction: column;
        gap: 5px;
        width: 100%;
      }

      .funnel-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 1rem;
        color: white;
        border-radius: 4px;
        font-size: 0.9rem;
        white-space: nowrap;
        overflow: hidden;
        transition: width 0.5s ease;
      }

      .funnel-label {
        font-weight: bold;
        margin-right: 1rem;
      }

      .funnel-value {
        font-size: 0.85rem;
      }

      /* テーブル */
      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9rem;
      }

      th {
        background-color: #f8f9fa;
        font-weight: bold;
        text-align: left;
        padding: 1rem;
        border-bottom: 2px solid #ddd;
        white-space: nowrap;
      }

      td {
        padding: 0.8rem 1rem;
        border-bottom: 1px solid #eee;
        vertical-align: middle;
      }

      tr:hover {
        background-color: #f8f9fa;
      }

      /* ボタン */
      .btn {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        transition: background 0.2s;
        text-decoration: none;
      }

      .btn-primary {
        background: var(--primary);
        color: white;
      }
      .btn-primary:hover {
        background: var(--primary-hover);
      }

      .btn-danger {
        background: #dc3545;
        color: white;
      }
      .btn-danger:hover {
        background: #c82333;
      }

      .btn-success {
        background: #28a745;
        color: white;
      }
      .btn-success:hover {
        background: #218838;
      }

      .btn-secondary {
        background: #6c757d;
        color: white;
      }
      .btn-secondary:hover {
        background: #5a6268;
      }

      .btn-sm {
        padding: 0.25rem 0.5rem;
        font-size: 0.8rem;
      }

      /* フォーム */
      .form-group {
        margin-bottom: 1rem;
      }
      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: bold;
      }
      .form-control {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid #ddd;
        border-radius: 4px;
      }
      .form-row {
        display: flex;
        gap: 1rem;
      }
      .form-row .form-group {
        flex: 1;
      }

      /* モーダル */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .modal.active {
        display: flex;
      }

      .modal-content {
        background: white;
        padding: 2rem;
        border-radius: 8px;
        width: 90%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        position: relative;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        border-bottom: 1px solid #eee;
        padding-bottom: 1rem;
      }

      .modal-title {
        margin: 0;
        font-size: 1.25rem;
        color: var(--primary);
      }
      .close-btn {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: #999;
      }

      /* カレンダー */
      .calendar-container {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 1px;
        background: #ddd;
        border: 1px solid #ddd;
      }

      .calendar-header {
        background: var(--primary);
        color: white;
        padding: 0.5rem;
        text-align: center;
        font-weight: bold;
      }

      .calendar-day {
        background: white;
        min-height: 120px;
        padding: 0.5rem;
        cursor: pointer;
        position: relative;
      }

      .calendar-day:hover {
        background-color: #f0f8ff;
      }
      .calendar-day.today {
        background-color: #e6f7ff;
      }
      .calendar-day.other-month {
        background-color: #f9f9f9;
        color: #ccc;
      }

      .schedule-item {
        background: var(--primary);
        color: white;
        padding: 2px 4px;
        margin-bottom: 2px;
        border-radius: 2px;
        font-size: 0.75rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      /* KPIプログレスバー */
      .progress-bar-container {
        width: 100%;
        background-color: #e9ecef;
        border-radius: 4px;
        height: 20px;
        margin: 0.5rem 0;
        overflow: hidden;
      }

      .progress-bar {
        height: 100%;
        background-color: #28a745;
        text-align: center;
        line-height: 20px;
        color: white;
        font-size: 0.8rem;
        transition: width 0.6s ease;
      }

      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #333;
        color: white;
        padding: 1rem;
        border-radius: 4px;
        z-index: 2000;
        display: none;
        animation: slideIn 0.3s;
      }

      @keyframes slideIn {
        from {
          transform: translateX(100%);
        }
        to {
          transform: translateX(0);
        }
      }
    </style>
  </head>
  <body>
    <!-- 1. ログイン画面 -->
    <div id="loginScreen" class="login-container">
      <div class="login-card">
        <div class="login-header">
          <h1><i class="fas fa-chart-line"></i> 販売管理システム</h1>
          <p>完全動作版</p>
        </div>
        <div
          style="
            background: #e3f2fd;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            text-align: left;
            font-size: 0.9rem;
          "
        >
          <strong><i class="fas fa-info-circle"></i> デモアカウント</strong><br />
          ユーザー名: <b>admin</b><br />
          パスワード: <b>password</b>
        </div>
        <form id="loginForm">
          <div class="form-group" style="text-align: left">
            <label>ユーザー名</label>
            <input type="text" id="username" class="form-control" value="admin" required />
          </div>
          <div class="form-group" style="text-align: left">
            <label>パスワード</label>
            <input type="password" id="password" class="form-control" value="password" required />
          </div>
          <button type="submit" class="btn btn-primary" style="width: 100%; justify-content: center; padding: 0.8rem">
            <i class="fas fa-sign-in-alt"></i> ログイン
          </button>
        </form>
      </div>
    </div>

    <!-- 2. アプリケーション画面 -->
    <div id="mainApp" class="app-container">
      <header class="app-header">
        <div class="app-title"><i class="fas fa-chart-line"></i> 販売管理システム</div>
        <div class="user-info">
          <span><i class="fas fa-user-circle"></i> <span id="currentUserDisplay">管理者 (大山)</span></span>
          <button id="logoutBtn" class="btn btn-sm btn-secondary">
            <i class="fas fa-sign-out-alt"></i> ログアウト
          </button>
        </div>
      </header>

      <nav class="tab-menu">
        <button class="tab-button active" onclick="app.showPage('dashboard')">
          <i class="fas fa-tachometer-alt"></i> ダッシュボード
        </button>
        <button class="tab-button" onclick="app.showPage('customers')"><i class="fas fa-users"></i> 顧客管理</button>
        <button class="tab-button" onclick="app.showPage('schedule')">
          <i class="fas fa-calendar-alt"></i> スケジュール
        </button>
        <button class="tab-button" onclick="app.showPage('activities')">
          <i class="fas fa-clipboard-list"></i> 活動記録
        </button>
        <button class="tab-button" onclick="app.showPage('kpi')"><i class="fas fa-bullseye"></i> KPI設定</button>
      </nav>

      <main class="main-content">
        <!-- ダッシュボード -->
        <section id="dashboardPage" class="page-section active">
          <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center">
              <h2>ダッシュボード</h2>
              <div style="display: flex; gap: 1rem; align-items: center">
                <label>表示フィルター:</label>
                <select id="dashboardFilter" class="form-control" style="width: auto" onchange="app.renderDashboard()">
                  <option value="all">全体</option>
                  <option value="user">個人 (大山)</option>
                </select>
                <select
                  id="dashboardAssignee"
                  class="form-control"
                  style="width: auto"
                  onchange="app.renderDashboard()"
                >
                  <option value="">担当者を選択...</option>
                  <!-- JSで担当者追加 -->
                </select>
              </div>
            </div>

            <div class="grid-stats">
              <div class="stat-card">
                <div class="stat-value" id="statCustomers">0</div>
                <div class="stat-label">総顧客数</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="statTodaySchedule">0</div>
                <div class="stat-label">本日の予定</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="statWeeklyActivity">0</div>
                <div class="stat-label">今週の活動</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="statTotalSales">¥0</div>
                <div class="stat-label">受注想定価格合計</div>
              </div>
            </div>

            <div class="grid-dashboard">
              <div class="card">
                <h3>担当者別活動状況</h3>
                <div class="chart-container">
                  <canvas id="chartActivity"></canvas>
                </div>
              </div>
              <div class="card">
                <h3>機種名別売上</h3>
                <div class="chart-container">
                  <canvas id="chartProduct"></canvas>
                </div>
              </div>
              <div class="card">
                <h3>ステージ別案件数</h3>
                <div id="funnelStage" class="funnel-container"></div>
              </div>
              <div class="card">
                <h3>確度別分布</h3>
                <div id="funnelProbability" class="funnel-container"></div>
              </div>
              <div class="card" style="grid-column: 1 / -1">
                <h3>受注予定タイムライン (KPI目標線付き)</h3>
                <div class="chart-container">
                  <canvas id="chartTimeline"></canvas>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- 顧客管理 -->
        <section id="customersPage" class="page-section">
          <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center">
              <h2>顧客管理</h2>
              <button class="btn btn-primary" onclick="app.openCustomerModal()">
                <i class="fas fa-plus"></i> 新規顧客追加
              </button>
            </div>
            <div style="overflow-x: auto">
              <table id="customerTable">
                <thead>
                  <tr>
                    <th>顧客名</th>
                    <th>業種</th>
                    <th>ランク</th>
                    <th>ステータス</th>
                    <th>主担当者</th>
                    <th>担当者数</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- JSで描画 -->
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- スケジュール -->
        <section id="schedulePage" class="page-section">
          <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem">
              <h2>スケジュール</h2>
              <div style="display: flex; gap: 0.5rem; align-items: center">
                <select id="scheduleViewMode" class="form-control" style="width: auto" onchange="app.renderSchedule()">
                  <option value="personal">個人</option>
                  <option value="multiple">複数選択</option>
                  <option value="all">全体</option>
                </select>
                <div id="scheduleAssigneeContainer" style="display: none">
                  <!-- チェックボックス等がここに入る -->
                </div>
                <select
                  id="scheduleDisplayType"
                  class="form-control"
                  style="width: auto"
                  onchange="app.renderSchedule()"
                >
                  <option value="calendar">カレンダー</option>
                  <option value="week">週間一覧</option>
                  <option value="month">月間一覧</option>
                </select>
                <button class="btn btn-primary" onclick="app.openScheduleModal()">
                  <i class="fas fa-plus"></i> 予定追加
                </button>
              </div>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin: 1rem 0">
              <button class="btn btn-secondary btn-sm" onclick="app.changeMonth(-1)">
                <i class="fas fa-chevron-left"></i> 前月
              </button>
              <h3 id="calendarTitle" style="margin: 0; border: none">2024年 12月</h3>
              <button class="btn btn-secondary btn-sm" onclick="app.changeMonth(1)">
                翌月 <i class="fas fa-chevron-right"></i>
              </button>
            </div>

            <div id="calendarView" class="calendar-container">
              <!-- カレンダー描画エリア -->
            </div>
            <div id="scheduleListView" style="display: none">
              <table id="scheduleListTable">
                <thead>
                  <tr>
                    <th>日時</th>
                    <th>担当者</th>
                    <th>タイトル</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- 活動記録 -->
        <section id="activitiesPage" class="page-section">
          <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem">
              <h2>活動記録</h2>
              <div style="display: flex; gap: 0.5rem">
                <button class="btn btn-success" onclick="app.exportReport('weekly')">
                  <i class="fas fa-file-csv"></i> 週報出力
                </button>
                <button class="btn btn-success" onclick="app.exportReport('monthly')">
                  <i class="fas fa-file-csv"></i> 月報出力
                </button>
                <button class="btn btn-primary" onclick="app.openActivityModal()">
                  <i class="fas fa-plus"></i> 記録追加
                </button>
              </div>
            </div>
            <div style="overflow-x: auto">
              <table id="activityTable">
                <thead>
                  <tr>
                    <th>日付</th>
                    <th>担当</th>
                    <th>得意先</th>
                    <th>目的</th>
                    <th>相手</th>
                    <th>商談内容</th>
                    <th>ステージ</th>
                    <th>確度</th>
                    <th>金額</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- JSで描画 -->
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- KPI設定 -->
        <section id="kpiPage" class="page-section">
          <div class="card">
            <h2>KPI設定</h2>
            <div class="grid-stats">
              <div class="stat-card">
                <div class="stat-label">全体売上目標</div>
                <input
                  type="number"
                  id="kpiTotalTarget"
                  class="form-control"
                  value="300000000"
                  onchange="app.saveKPI()"
                />
              </div>
              <div class="stat-card">
                <div class="stat-label">個人売上目標 (大山)</div>
                <input
                  type="number"
                  id="kpiPersonalTarget"
                  class="form-control"
                  value="100000000"
                  onchange="app.saveKPI()"
                />
              </div>
            </div>

            <div class="card">
              <h3>達成状況</h3>
              <div style="margin-bottom: 1rem">
                <div style="display: flex; justify-content: space-between">
                  <span>全体達成率</span>
                  <span id="kpiTotalRate">0%</span>
                </div>
                <div class="progress-bar-container">
                  <div id="kpiTotalBar" class="progress-bar" style="width: 0%"></div>
                </div>
                <div style="text-align: right; font-size: 0.9rem; color: #666">
                  不足: <span id="kpiTotalShortage">¥300,000,000</span>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between">
                  <span>個人達成率</span>
                  <span id="kpiPersonalRate">0%</span>
                </div>
                <div class="progress-bar-container">
                  <div id="kpiPersonalBar" class="progress-bar" style="width: 0%"></div>
                </div>
                <div style="text-align: right; font-size: 0.9rem; color: #666">
                  不足: <span id="kpiPersonalShortage">¥100,000,000</span>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- モーダル群 -->
    <div id="customerModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">顧客情報</h3>
          <button class="close-btn" onclick="app.closeModal('customerModal')">&times;</button>
        </div>
        <form id="customerForm">
          <input type="hidden" id="customerId" />
          <div class="form-group">
            <label>顧客名 *</label><input type="text" id="customerName" class="form-control" required />
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>業種</label><input type="text" id="customerIndustry" class="form-control" />
            </div>
            <div class="form-group">
              <label>ランク</label>
              <select id="customerRank" class="form-control">
                <option>A</option>
                <option>B</option>
                <option>C</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>主担当者</label>
            <select id="customerAssignee" class="form-control"></select>
          </div>
          <div style="text-align: right; margin-top: 1rem">
            <button type="button" class="btn btn-secondary" onclick="app.closeModal('customerModal')">
              キャンセル
            </button>
            <button type="submit" class="btn btn-primary">保存</button>
          </div>
        </form>
      </div>
    </div>

    <div id="scheduleModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">予定情報</h3>
          <button class="close-btn" onclick="app.closeModal('scheduleModal')">&times;</button>
        </div>
        <form id="scheduleForm">
          <input type="hidden" id="scheduleId" />
          <div class="form-group">
            <label>タイトル *</label><input type="text" id="scheduleTitle" class="form-control" required />
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>日付 *</label><input type="date" id="scheduleDate" class="form-control" required />
            </div>
            <div class="form-group">
              <label>時間</label><input type="time" id="scheduleTime" class="form-control" step="900" />
            </div>
          </div>
          <div class="form-group">
            <label>担当者 *</label>
            <select id="scheduleAssigneeEdit" class="form-control" required></select>
          </div>
          <div style="text-align: right; margin-top: 1rem">
            <button
              type="button"
              class="btn btn-danger"
              id="deleteScheduleBtn"
              style="float: left"
              onclick="app.deleteSchedule()"
            >
              削除
            </button>
            <button type="button" class="btn btn-secondary" onclick="app.closeModal('scheduleModal')">
              キャンセル
            </button>
            <button type="submit" class="btn btn-primary">保存</button>
          </div>
        </form>
      </div>
    </div>

    <div id="activityModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">活動記録</h3>
          <button class="close-btn" onclick="app.closeModal('activityModal')">&times;</button>
        </div>
        <form id="activityForm">
          <input type="hidden" id="activityId" />
          <div class="form-row">
            <div class="form-group">
              <label>日付 *</label><input type="date" id="activityDate" class="form-control" required />
            </div>
            <div class="form-group">
              <label>担当者 *</label
              ><select id="activityAssignee" class="form-control" required></select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>得意先 *</label
              ><select id="activityCustomer" class="form-control" required></select>
            </div>
            <div class="form-group">
              <label>目的 *</label>
              <select id="activityPurpose" class="form-control" required>
                <option value="A">A：新規事業活動</option>
                <option value="B">B：商談促進</option>
                <option value="C">C：仕様打合せ</option>
                <option value="D">D：納入・営業立会い</option>
                <option value="E">E：クレーム対応</option>
                <option value="F">F：無償作業</option>
                <option value="G">G：有償作業</option>
                <option value="H">H：相談・アドバイス</option>
                <option value="I">I：部品調査</option>
                <option value="J">J：情報収集</option>
                <option value="K">K：社内業務</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>相手</label><input type="text" id="activityContact" class="form-control" />
            </div>
            <div class="form-group">
              <label>機種名</label><input type="text" id="activityProduct" class="form-control" />
            </div>
          </div>
          <div class="form-group">
            <label>商談内容</label><textarea id="activityContent" class="form-control" rows="3"></textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>ステージ</label>
              <select id="activityStage" class="form-control">
                <option value="情報収集">情報収集</option>
                <option value="アプローチ">アプローチ</option>
                <option value="提案・見積">提案・見積</option>
                <option value="評価・デモ">評価・デモ</option>
                <option value="クロージング">クロージング</option>
                <option value="受注">受注</option>
              </select>
            </div>
            <div class="form-group">
              <label>確度</label>
              <select id="activityProbability" class="form-control">
                <option value="A">A (高)</option>
                <option value="B">B (中)</option>
                <option value="C">C (低)</option>
                <option value="D">D (なし)</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>受注予定日</label><input type="date" id="activityExpectedDate" class="form-control" />
            </div>
            <div class="form-group">
              <label>受注想定価格</label><input type="number" id="activityAmount" class="form-control" />
            </div>
          </div>
          <div class="form-group">
            <label>ネクストアクション</label><input type="text" id="activityNextAction" class="form-control" />
          </div>
          <div class="form-group"><label>備考</label><input type="text" id="activityNote" class="form-control" /></div>

          <div style="text-align: right; margin-top: 1rem">
            <button
              type="button"
              class="btn btn-danger"
              id="deleteActivityBtn"
              style="float: left"
              onclick="app.deleteActivity()"
            >
              削除
            </button>
            <button type="button" class="btn btn-secondary" onclick="app.closeModal('activityModal')">
              キャンセル
            </button>
            <button type="submit" class="btn btn-primary">保存</button>
          </div>
        </form>
      </div>
    </div>

    <div id="toast" class="toast"></div>

    <script>
      // 定数
      const STAFF_MEMBERS = ['永森', '箱崎', '清水', '杉田', '安里', '鎌田', '大山'];
      const CURRENT_USER = { username: 'admin', assignee: '大山' };

      class SalesApp {
        constructor() {
          this.data = {
            customers: [],
            schedules: [],
            activities: [],
            kpi: { total: 300000000, personal: 100000000 },
          };
          this.currentDate = new Date();
          this.charts = {};

          this.init();
        }

        init() {
          this.loadData();
          this.setupEventListeners();

          // 担当者プルダウンの初期化
          const assigneeOptions = STAFF_MEMBERS.map((m) => `<option value="${m}">${m}</option>`).join('');
          document
            .querySelectorAll('#dashboardAssignee, #customerAssignee, #scheduleAssigneeEdit, #activityAssignee')
            .forEach((el) => {
              el.innerHTML += assigneeOptions;
            });

          // チェックボックスコンテナの初期化（スケジュール複数選択用）
          const checkboxHtml = STAFF_MEMBERS.map(
            (m) =>
              `<label style="margin-right:10px;"><input type="checkbox" class="schedule-checkbox" value="${m}" onchange="app.renderSchedule()"> ${m}</label>`,
          ).join('');
          document.getElementById('scheduleAssigneeContainer').innerHTML = checkboxHtml;
        }

        loadData() {
          const stored = localStorage.getItem('salesAppData');
          if (stored) {
            this.data = JSON.parse(stored);
          } else {
            // サンプルデータ
            this.data.customers = [
              { id: 1, name: '株式会社A', industry: '製造', rank: 'A', status: '取引中', assignee: '大山' },
              { id: 2, name: 'B商事', industry: '商社', rank: 'B', status: 'アプローチ中', assignee: '永森' },
            ];
            this.data.schedules = [
              { id: 1, title: '訪問', date: new Date().toISOString().split('T')[0], time: '10:00', assignee: '大山' },
              { id: 2, title: '会議', date: new Date().toISOString().split('T')[0], time: '13:00', assignee: '永森' },
            ];
            this.data.activities = [
              {
                id: 1,
                date: new Date().toISOString().split('T')[0],
                assignee: '大山',
                customerId: 1,
                purpose: 'B',
                contact: '田中部長',
                product: '新機種X',
                content: '提案書提出',
                stage: '提案・見積',
                probability: 'A',
                expectedDate: '2024-12-31',
                amount: 5000000,
                nextAction: '見積修正',
                note: '',
              },
            ];
            this.saveData();
          }
        }

        saveData() {
          localStorage.setItem('salesAppData', JSON.stringify(this.data));
        }

        setupEventListeners() {
          document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            if (u === 'admin' && p === 'password') {
              document.getElementById('loginScreen').style.display = 'none';
              document.getElementById('mainApp').style.display = 'flex';
              this.renderDashboard();
            } else {
              alert('ログイン情報が誤っています');
            }
          });

          document.getElementById('logoutBtn').addEventListener('click', () => {
            location.reload();
          });

          // フォーム送信イベント
          document.getElementById('customerForm').addEventListener('submit', (e) => this.saveCustomer(e));
          document.getElementById('scheduleForm').addEventListener('submit', (e) => this.saveSchedule(e));
          document.getElementById('activityForm').addEventListener('submit', (e) => this.saveActivity(e));

          // スケジュール表示モード変更
          document.getElementById('scheduleViewMode').addEventListener('change', (e) => {
            const container = document.getElementById('scheduleAssigneeContainer');
            container.style.display = e.target.value === 'multiple' ? 'block' : 'none';
            this.renderSchedule();
          });
        }

        showPage(pageId) {
          document.querySelectorAll('.page-section').forEach((el) => el.classList.remove('active'));
          document.getElementById(pageId + 'Page').classList.add('active');
          document.querySelectorAll('.tab-button').forEach((el) => el.classList.remove('active'));
          event.currentTarget.classList.add('active');

          if (pageId === 'dashboard') this.renderDashboard();
          if (pageId === 'customers') this.renderCustomers();
          if (pageId === 'schedule') this.renderSchedule();
          if (pageId === 'activities') this.renderActivities();
          if (pageId === 'kpi') this.renderKPI();
        }

        // --- ダッシュボード ---
        renderDashboard() {
          const filter = document.getElementById('dashboardFilter').value;
          const assignee = document.getElementById('dashboardAssignee').value;
          let activities = this.data.activities;

          if (filter === 'user') {
            activities = activities.filter((a) => a.assignee === '大山');
          } else if (assignee) {
            activities = activities.filter((a) => a.assignee === assignee);
          }

          // 統計カード
          document.getElementById('statCustomers').textContent = this.data.customers.length;
          const today = new Date().toISOString().split('T')[0];
          document.getElementById('statTodaySchedule').textContent = this.data.schedules.filter(
            (s) => s.date === today,
          ).length;
          document.getElementById('statWeeklyActivity').textContent = activities.length; // 簡易的に全件表示
          const totalSales = activities.reduce((sum, a) => sum + (Number(a.amount) || 0), 0);
          document.getElementById('statTotalSales').textContent = '¥' + totalSales.toLocaleString();

          this.drawCharts(activities);
        }

        drawCharts(activities) {
          // Chart.js破棄
          Object.values(this.charts).forEach((chart) => chart.destroy());

          // 1. 活動状況（棒グラフ・整数）
          const activityCounts = STAFF_MEMBERS.map((staff) => activities.filter((a) => a.assignee === staff).length);
          this.charts.activity = new Chart(document.getElementById('chartActivity'), {
            type: 'bar',
            data: {
              labels: STAFF_MEMBERS,
              datasets: [{ label: '活動件数', data: activityCounts, backgroundColor: '#2c5aa0' }],
            },
            options: { scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } } },
          });

          // 2. 機種名別売上（ドーナツ）
          const productSales = {};
          activities.forEach((a) => {
            if (a.product) productSales[a.product] = (productSales[a.product] || 0) + (Number(a.amount) || 0);
          });
          this.charts.product = new Chart(document.getElementById('chartProduct'), {
            type: 'doughnut',
            data: {
              labels: Object.keys(productSales),
              datasets: [
                {
                  data: Object.values(productSales),
                  backgroundColor: ['#2c5aa0', '#28a745', '#ffc107', '#dc3545', '#17a2b8'],
                },
              ],
            },
          });

          // 3. 受注予定タイムライン
          const timelineData = {};
          activities.forEach((a) => {
            if (a.expectedDate) {
              const ym = a.expectedDate.substring(0, 7);
              timelineData[ym] = (timelineData[ym] || 0) + (Number(a.amount) || 0);
            }
          });
          const sortedKeys = Object.keys(timelineData).sort();
          let cumulative = 0;
          const cumulativeData = sortedKeys.map((k) => {
            cumulative += timelineData[k];
            return cumulative;
          });

          this.charts.timeline = new Chart(document.getElementById('chartTimeline'), {
            type: 'line',
            data: {
              labels: sortedKeys,
              datasets: [
                { label: '累積受注額', data: cumulativeData, borderColor: '#2c5aa0', fill: false },
                {
                  label: '全体目標',
                  data: Array(sortedKeys.length).fill(this.data.kpi.total),
                  borderColor: '#dc3545',
                  borderDash: [5, 5],
                  fill: false,
                },
              ],
            },
          });

          // 4. ファネル（HTMLで描画）
          this.renderFunnel('funnelStage', activities, 'stage', [
            '情報収集',
            'アプローチ',
            '提案・見積',
            '評価・デモ',
            'クロージング',
            '受注',
          ]);
          this.renderFunnel('funnelProbability', activities, 'probability', ['A', 'B', 'C', 'D']);
        }

        renderFunnel(elementId, data, key, labels) {
          const container = document.getElementById(elementId);
          container.innerHTML = '';
          const counts = {};
          const amounts = {};
          let totalAmount = 0;

          labels.forEach((l) => {
            counts[l] = 0;
            amounts[l] = 0;
          });
          data.forEach((d) => {
            if (counts[d[key]] !== undefined) {
              counts[d[key]]++;
              amounts[d[key]] += Number(d.amount) || 0;
              totalAmount += Number(d.amount) || 0;
            }
          });

          const maxAmount = Math.max(...Object.values(amounts)) || 1;

          labels.forEach((label, index) => {
            const count = counts[label];
            const amount = amounts[label];
            const widthPercent = amount === 0 ? 25 : 25 + (amount / maxAmount) * 75;
            const color =
              key === 'probability'
                ? ['#28a745', '#ffc107', '#fd7e14', '#dc3545'][index]
                : `rgba(44, 90, 160, ${1 - index * 0.1})`;

            container.innerHTML += `
              <div class="funnel-item" style="width: ${widthPercent}%; background-color: ${color};">
                <span class="funnel-label">${label}</span>
                <span class="funnel-value">${count}件 (¥${amount.toLocaleString()})</span>
              </div>
            `;
          });
        }

        // --- 顧客管理 ---
        renderCustomers() {
          const tbody = document.querySelector('#customerTable tbody');
          tbody.innerHTML = this.data.customers
            .map(
              (c) => `
            <tr>
              <td><a href="#" onclick="alert('担当者一覧機能は実装中です')">${c.name}</a></td>
              <td>${c.industry || '-'}</td>
              <td>${c.rank || '-'}</td>
              <td>${c.status || '-'}</td>
              <td>${c.assignee || '-'}</td>
              <td>1</td>
              <td>
                <button class="btn btn-sm btn-primary" onclick="app.editCustomer(${c.id})">編集</button>
                <button class="btn btn-sm btn-danger" onclick="app.deleteCustomer(${c.id})">削除</button>
              </td>
            </tr>
          `,
            )
            .join('');
        }

        openCustomerModal() {
          document.getElementById('customerForm').reset();
          document.getElementById('customerId').value = '';
          this.openModal('customerModal');
        }

        editCustomer(id) {
          const c = this.data.customers.find((x) => x.id === id);
          if (c) {
            document.getElementById('customerId').value = c.id;
            document.getElementById('customerName').value = c.name;
            document.getElementById('customerIndustry').value = c.industry;
            document.getElementById('customerRank').value = c.rank;
            document.getElementById('customerAssignee').value = c.assignee;
            this.openModal('customerModal');
          }
        }

        saveCustomer(e) {
          e.preventDefault();
          const id = document.getElementById('customerId').value;
          const customer = {
            id: id ? Number(id) : Date.now(),
            name: document.getElementById('customerName').value,
            industry: document.getElementById('customerIndustry').value,
            rank: document.getElementById('customerRank').value,
            assignee: document.getElementById('customerAssignee').value,
            status: '取引中',
          };

          if (id) {
            const idx = this.data.customers.findIndex((x) => x.id == id);
            this.data.customers[idx] = customer;
          } else {
            this.data.customers.push(customer);
          }
          this.saveData();
          this.closeModal('customerModal');
          this.renderCustomers();
          this.showToast('顧客情報を保存しました');
        }

        deleteCustomer(id) {
          if (confirm('削除しますか？')) {
            this.data.customers = this.data.customers.filter((x) => x.id !== id);
            this.saveData();
            this.renderCustomers();
          }
        }

        // --- スケジュール ---
        renderSchedule() {
          const viewMode = document.getElementById('scheduleViewMode').value;
          const displayType = document.getElementById('scheduleDisplayType').value;
          let schedules = this.data.schedules;

          // フィルタリング
          if (viewMode === 'personal') {
            schedules = schedules.filter((s) => s.assignee === '大山');
          } else if (viewMode === 'multiple') {
            const checked = Array.from(document.querySelectorAll('.schedule-checkbox:checked')).map((c) => c.value);
            if (checked.length > 0) schedules = schedules.filter((s) => checked.includes(s.assignee));
          }

          if (displayType === 'calendar') {
            document.getElementById('calendarView').style.display = 'grid';
            document.getElementById('scheduleListView').style.display = 'none';
            this.renderCalendar(schedules);
          } else {
            document.getElementById('calendarView').style.display = 'none';
            document.getElementById('scheduleListView').style.display = 'block';
            this.renderScheduleList(schedules);
          }
        }

        renderCalendar(schedules) {
          const calendar = document.getElementById('calendarView');
          calendar.innerHTML = '';
          const days = ['日', '月', '火', '水', '木', '金', '土'];
          days.forEach((d) => (calendar.innerHTML += `<div class="calendar-header">${d}</div>`));

          const year = this.currentDate.getFullYear();
          const month = this.currentDate.getMonth();
          document.getElementById('calendarTitle').textContent = `${year}年 ${month + 1}月`;

          const firstDay = new Date(year, month, 1);
          const lastDay = new Date(year, month + 1, 0);
          const startDate = new Date(firstDay);
          startDate.setDate(startDate.getDate() - startDate.getDay());

          for (let i = 0; i < 42; i++) {
            // 6週間分
            const d = new Date(startDate);
            d.setDate(d.getDate() + i);
            const dateStr = d.toISOString().split('T')[0];
            const isToday = dateStr === new Date().toISOString().split('T')[0];
            const isOtherMonth = d.getMonth() !== month;

            let html = `<div class="calendar-day ${isToday ? 'today' : ''} ${isOtherMonth ? 'other-month' : ''}" onclick="app.openScheduleModal('${dateStr}')">`;
            html += `<div style="text-align:right; font-size:0.8rem; margin-bottom:4px;">${d.getDate()}</div>`;

            schedules
              .filter((s) => s.date === dateStr)
              .forEach((s) => {
                html += `<div class="schedule-item" onclick="event.stopPropagation(); app.editSchedule(${s.id})">[${s.assignee}] ${s.time} ${s.title}</div>`;
              });
            html += '</div>';
            calendar.innerHTML += html;
          }
        }

        renderScheduleList(schedules) {
          const tbody = document.querySelector('#scheduleListTable tbody');
          tbody.innerHTML = schedules
            .map(
              (s) => `
            <tr>
              <td>${s.date} ${s.time}</td>
              <td>${s.assignee}</td>
              <td>${s.title}</td>
              <td><button class="btn btn-sm btn-primary" onclick="app.editSchedule(${s.id})">編集</button></td>
            </tr>
          `,
            )
            .join('');
        }

        changeMonth(delta) {
          this.currentDate.setMonth(this.currentDate.getMonth() + delta);
          this.renderSchedule();
        }

        openScheduleModal(dateStr) {
          document.getElementById('scheduleForm').reset();
          document.getElementById('scheduleId').value = '';
          document.getElementById('deleteScheduleBtn').style.display = 'none';
          if (dateStr) document.getElementById('scheduleDate').value = dateStr;
          this.openModal('scheduleModal');
        }

        editSchedule(id) {
          const s = this.data.schedules.find((x) => x.id === id);
          if (s) {
            document.getElementById('scheduleId').value = s.id;
            document.getElementById('scheduleTitle').value = s.title;
            document.getElementById('scheduleDate').value = s.date;
            document.getElementById('scheduleTime').value = s.time;
            document.getElementById('scheduleAssigneeEdit').value = s.assignee;
            document.getElementById('deleteScheduleBtn').style.display = 'inline-block';
            this.openModal('scheduleModal');
          }
        }

        saveSchedule(e) {
          e.preventDefault();
          const id = document.getElementById('scheduleId').value;
          const schedule = {
            id: id ? Number(id) : Date.now(),
            title: document.getElementById('scheduleTitle').value,
            date: document.getElementById('scheduleDate').value,
            time: document.getElementById('scheduleTime').value,
            assignee: document.getElementById('scheduleAssigneeEdit').value,
          };

          if (id) {
            const idx = this.data.schedules.findIndex((x) => x.id == id);
            this.data.schedules[idx] = schedule;
          } else {
            this.data.schedules.push(schedule);
          }
          this.saveData();
          this.closeModal('scheduleModal');
          this.renderSchedule();
          this.showToast('予定を保存しました');
        }

        deleteSchedule() {
          const id = Number(document.getElementById('scheduleId').value);
          if (confirm('削除しますか？')) {
            this.data.schedules = this.data.schedules.filter((x) => x.id !== id);
            this.saveData();
            this.closeModal('scheduleModal');
            this.renderSchedule();
          }
        }

        // --- 活動記録 ---
        renderActivities() {
          const tbody = document.querySelector('#activityTable tbody');
          tbody.innerHTML = this.data.activities
            .map((a) => {
              const customerName = this.data.customers.find((c) => c.id == a.customerId)?.name || '不明';
              const shortContent = a.content && a.content.length > 30 ? a.content.substring(0, 30) + '...' : a.content;
              return `
              <tr>
                <td>${a.date}</td>
                <td>${a.assignee}</td>
                <td>${customerName}</td>
                <td>${a.purpose}</td>
                <td>${a.contact || '-'}</td>
                <td title="${a.content}" style="cursor:pointer; color:#2c5aa0;" onclick="alert('${a.content}')">${shortContent}</td>
                <td>${a.stage || '-'}</td>
                <td>${a.probability || '-'}</td>
                <td>¥${(Number(a.amount) || 0).toLocaleString()}</td>
                <td>
                  <button class="btn btn-sm btn-primary" onclick="app.editActivity(${a.id})">編集</button>
                  <button class="btn btn-sm btn-danger" onclick="app.deleteActivity(${a.id})">削除</button>
                </td>
              </tr>
            `;
            })
            .join('');
        }

        openActivityModal() {
          document.getElementById('activityForm').reset();
          document.getElementById('activityId').value = '';
          document.getElementById('deleteActivityBtn').style.display = 'none';
          this.updateCustomerSelect();
          this.openModal('activityModal');
        }

        updateCustomerSelect() {
          const select = document.getElementById('activityCustomer');
          select.innerHTML = this.data.customers.map((c) => `<option value="${c.id}">${c.name}</option>`).join('');
        }

        editActivity(id) {
          const a = this.data.activities.find((x) => x.id === id);
          if (a) {
            this.updateCustomerSelect();
            document.getElementById('activityId').value = a.id;
            document.getElementById('activityDate').value = a.date;
            document.getElementById('activityAssignee').value = a.assignee;
            document.getElementById('activityCustomer').value = a.customerId;
            document.getElementById('activityPurpose').value = a.purpose;
            document.getElementById('activityContact').value = a.contact;
            document.getElementById('activityProduct').value = a.product;
            document.getElementById('activityContent').value = a.content;
            document.getElementById('activityStage').value = a.stage;
            document.getElementById('activityProbability').value = a.probability;
            document.getElementById('activityExpectedDate').value = a.expectedDate;
            document.getElementById('activityAmount').value = a.amount;
            document.getElementById('activityNextAction').value = a.nextAction;
            document.getElementById('activityNote').value = a.note;
            document.getElementById('deleteActivityBtn').style.display = 'inline-block';
            this.openModal('activityModal');
          }
        }

        saveActivity(e) {
          e.preventDefault();
          const id = document.getElementById('activityId').value;
          const activity = {
            id: id ? Number(id) : Date.now(),
            date: document.getElementById('activityDate').value,
            assignee: document.getElementById('activityAssignee').value,
            customerId: document.getElementById('activityCustomer').value,
            purpose: document.getElementById('activityPurpose').value,
            contact: document.getElementById('activityContact').value,
            product: document.getElementById('activityProduct').value,
            content: document.getElementById('activityContent').value,
            stage: document.getElementById('activityStage').value,
            probability: document.getElementById('activityProbability').value,
            expectedDate: document.getElementById('activityExpectedDate').value,
            amount: document.getElementById('activityAmount').value,
            nextAction: document.getElementById('activityNextAction').value,
            note: document.getElementById('activityNote').value,
          };

          if (id) {
            const idx = this.data.activities.findIndex((x) => x.id == id);
            this.data.activities[idx] = activity;
          } else {
            this.data.activities.push(activity);
          }
          this.saveData();
          this.closeModal('activityModal');
          this.renderActivities();
          this.showToast('活動記録を保存しました');
        }

        deleteActivity(id = null) {
          const targetId = id || Number(document.getElementById('activityId').value);
          if (confirm('削除しますか？')) {
            this.data.activities = this.data.activities.filter((x) => x.id !== targetId);
            this.saveData();
            if (!id) this.closeModal('activityModal');
            this.renderActivities();
          }
        }

        exportReport(type) {
          const assignee = prompt('対象の担当者を入力してください（空白で全体）', '大山');
          let data = this.data.activities;
          if (assignee) data = data.filter((a) => a.assignee === assignee);

          if (type === 'weekly') {
            // 週報: 日付、目的、訪問先、商談内容
            let csv = '日付,目的,訪問先,商談内容\n';
            data.forEach((a) => {
              const customer = this.data.customers.find((c) => c.id == a.customerId)?.name || '';
              csv += `${a.date},${a.purpose},${customer},"${a.content.replace(/"/g, '""')}"\n`;
            });
            this.downloadCSV(csv, `週報_${assignee || '全体'}.csv`);
          } else {
            // 月報
            let csv = '日付,担当,得意先,機種,金額,確度\n';
            data.forEach((a) => {
              const customer = this.data.customers.find((c) => c.id == a.customerId)?.name || '';
              csv += `${a.date},${a.assignee},${customer},${a.product},${a.amount},${a.probability}\n`;
            });
            this.downloadCSV(csv, `月報_${assignee || '全体'}.csv`);
          }
        }

        downloadCSV(content, filename) {
          const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
          const link = document.createElement('a');
          link.href = URL.createObjectURL(blob);
          link.download = filename;
          link.click();
        }

        // --- KPI ---
        renderKPI() {
          document.getElementById('kpiTotalTarget').value = this.data.kpi.total;
          document.getElementById('kpiPersonalTarget').value = this.data.kpi.personal;

          const totalSales = this.data.activities.reduce((sum, a) => sum + (Number(a.amount) || 0), 0);
          const personalSales = this.data.activities
            .filter((a) => a.assignee === '大山')
            .reduce((sum, a) => sum + (Number(a.amount) || 0), 0);

          const updateBar = (id, current, target) => {
            const rate = Math.min(100, Math.round((current / target) * 100));
            const bar = document.getElementById(id + 'Bar');
            bar.style.width = rate + '%';
            bar.textContent = rate + '%';
            document.getElementById(id + 'Rate').textContent = rate + '%';
            document.getElementById(id + 'Shortage').textContent = '¥' + Math.max(0, target - current).toLocaleString();
          };

          updateBar('kpiTotal', totalSales, this.data.kpi.total);
          updateBar('kpiPersonal', personalSales, this.data.kpi.personal);
        }

        saveKPI() {
          this.data.kpi.total = Number(document.getElementById('kpiTotalTarget').value);
          this.data.kpi.personal = Number(document.getElementById('kpiPersonalTarget').value);
          this.saveData();
          this.renderKPI();
          this.showToast('KPI設定を保存しました');
        }

        // 共通メソッド
        openModal(id) {
          document.getElementById(id).classList.add('active');
        }
        closeModal(id) {
          document.getElementById(id).classList.remove('active');
        }

        showToast(message) {
          const toast = document.getElementById('toast');
          toast.textContent = message;
          toast.style.display = 'block';
          setTimeout(() => {
            toast.style.display = 'none';
          }, 3000);
        }
      }

      const app = new SalesApp();
    </script>
  </body>
</html>
